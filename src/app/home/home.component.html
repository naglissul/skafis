<main>
  <aside></aside>
  <section>
    <app-title-description />
    <form [formGroup]="titleForm">
      <mat-form-field appearance="outline" class="form-title">
        <mat-label>Pavadinimas</mat-label>
        <textarea
          matInput
          placeholder="Įveskite pavadinimą"
          formControlName="title"
          rows="1"
        ></textarea>
        <mat-error *ngIf="titleForm.get('title')?.errors?.['required']">
          Pavadinimas yra privalomas
        </mat-error>
      </mat-form-field>

      <div formArrayName="questions">
        <div
          *ngFor="let question of questions.controls; let i = index"
          [formGroupName]="i"
        >
          <div class="question-number">{{ i + 1 }}.</div>
          <div class="question-block">
            <mat-form-field appearance="outline" class="question-text-field">
              <mat-label>Klausimas</mat-label>
              <textarea
                [required]="false"
                matInput
                placeholder="Įveskite klausimo formuluotę"
                formControlName="text"
                rows="1"
              ></textarea>
            </mat-form-field>

            <mat-radio-group
              aria-label="Select an option"
              formControlName="selectedOption"
              *ngIf="titleForm.get(['questions', i, 'type'])?.value === 'ABCD'"
              [style.width.%]="100"
            >
              <div formArrayName="options">
                <div *ngFor="let ctrl of getOptions(i).controls; let j = index">
                  <div class="option-letter">
                    {{ j === 0 ? "A" : j === 1 ? "B" : j === 2 ? "C" : "D" }}
                  </div>
                  <mat-form-field appearance="outline">
                    <mat-label>Pasirinkimas</mat-label>
                    <textarea
                      matInput
                      [placeholder]="'Įveskite pasirinkimo formuluotę'"
                      [formControlName]="j"
                      [required]="false"
                      rows="1"
                    ></textarea>
                  </mat-form-field>
                  <mat-radio-button [value]="j"></mat-radio-button>
                  <div class="isCorrectMsg">
                    {{
                      titleForm.get(["questions", i, "selectedOption"])
                        ?.value === j
                        ? "Teisingas atsakymas"
                        : "Neteisingas atsakymas"
                    }}
                  </div>
                </div>
              </div>
            </mat-radio-group>
            <mat-form-field
              *ngIf="titleForm.get(['questions', i, 'type'])?.value === 'OPEN'"
              appearance="outline"
              [style.width.%]="50"
            >
              <textarea
                [required]="false"
                matInput
                placeholder="Įveskite atsakymą"
                formControlName="answerText"
                rows="1"
              ></textarea>
            </mat-form-field>
          </div>
        </div>
      </div>

      <button
        type="button"
        mat-raised-button
        color="secondary"
        (click)="addABCDQuestion()"
      >
        Pridėti ABCD klausimą
      </button>
      <!-- <button
        type="button"
        mat-raised-button
        color="secondary"
        (click)="addOpenQuestion()"
      >
        Pridėti atvirą klausimą
      </button> -->
      <button
        *ngIf="questions.length > 1"
        type="button"
        mat-raised-button
        color="warn"
        (click)="removeLastQuestion()"
      >
        Pašalinti paskutinį klausimą
      </button>

      <br />
      <br />
      <br />
      <br />
      <button
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="titleForm.invalid"
        (click)="generateHTML()"
      >
        Atsisiųsti HTML
      </button>
      <button
        mat-raised-button
        color="accent"
        [disabled]="titleForm.invalid"
        (click)="generateImagePDF()"
      >
        Atsisiųsti PDF su atsakymais
      </button>
      <button
        mat-raised-button
        color="accent"
        [disabled]="titleForm.invalid"
        (click)="generateImagePDFNoAns()"
      >
        Atsisiųsti PDF be atsakymų
      </button>
      <!-- <button
        mat-outlined-button
        color="secondary"
        [disabled]="titleForm.invalid"
        (click)="generateTextPDF()"
      >
        Atsisiųsti geresnės kokybės tekstinį PDF (be lietuviškų raidžių)
      </button> -->
      <br />
      <br />
      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="clearForm()"
      >
        Išvalyti viską
      </button>
      <button
        type="button"
        mat-raised-button
        color="primary"
        (click)="fillExampleForm()"
      >
        Užpildyti pavyzdinėmis užduotimis
      </button>
    </form>
  </section>
  <aside></aside>
</main>
<app-privacy-footer />
